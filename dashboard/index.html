<!DOCTYPE html>
<html>
<head>
<title>Attendance Dashboard</title>

<script type="module">
import { initializeApp } 
from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";

import { getFirestore, collection, onSnapshot } 
from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyB-cRwUJ8zcb1pWbToYXMtZg76vjhTMUPs",
  authDomain: "attendance-system-b1d37.firebaseapp.com",
  projectId: "attendance-system-b1d37",
  storageBucket: "attendance-system-b1d37.firebasestorage.app",
  messagingSenderId: "298377818582",
  appId: "1:298377818582:web:48222962ad7981828f3477"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

onSnapshot(collection(db, "attendance"), (snapshot) => {
    const count = snapshot.size;
    document.getElementById("total").innerText = count;

    let busCount = {1:0,2:0,3:0,4:0,5:0};

    snapshot.forEach(doc => {
        let bus = doc.data().bus.split(" ")[1];
        busCount[bus]++;
    });

    for (let i=1;i<=5;i++){
        document.getElementById("bus"+i).innerText = busCount[i];
    }
});
</script>
<script type="module" src="../firebase.js"></script>


<style>
body { font-family: Arial; padding: 20px; }
.box { padding: 10px; margin: 10px; background:#eee; border-radius: 10px; }
</style>
</head>

<body>
<h2>Live Attendance Dashboard</h2>

<div class="box">Total Marked Attendees: <strong id="total">0</strong></div>

<div class="box">Bus 1: <span id="bus1">0</span></div>
<div class="box">Bus 2: <span id="bus2">0</span></div>
<div class="box">Bus 3: <span id="bus3">0</span></div>
<div class="box">Bus 4: <span id="bus4">0</span></div>
<div class="box">Bus 5: <span id="bus5">0</span></div>

</body>
</html>
